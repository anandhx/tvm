<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Trivandrum Places Collection</title>

<style>
body {
    font-family: Arial, sans-serif;
    padding: 20px;
    background: #f7f7f7;
}
h1 {
    text-align: center;
}
.category-box {
    background: white;
    padding: 16px;
    margin-top: 25px;
    border-radius: 8px;
    box-shadow: 0 0 8px rgba(0,0,0,0.08);
}
.place {
    padding: 6px 0;
    border-bottom: 1px solid #eee;
}
.place:last-child {
    border-bottom: none;
}
.community-badge {
    background: #007bff;
    color: white;
    padding: 3px 6px;
    font-size: 11px;
    border-radius: 4px;
    margin-left: 6px;
}
footer {
    text-align: center;
    margin-top: 40px;
    color: #666;
    font-size: 14px;
}
</style>
</head>

<body>

<h1>Trivandrum Places Directory</h1>
<p style="text-align:center;">⭐ A community-powered list of best places in Trivandrum  
<br>Users can contribute new locations using the Google Form.</p>

<hr>

<h3>Add a New Place:</h3>
<p>
  <a href="https://forms.gle/hNbku69a3nmCrVEj7" target="_blank">
    ➡ Click here to add a place
  </a>
</p>

<div id="hardcoded"></div>
<div id="community"></div>

<!-- PapaParse for proper CSV parsing -->
<script src="https://unpkg.com/papaparse@5.3.2/papaparse.min.js"></script>

<script>
// ----------------------------
// 1. HARDCODED LIST
// ----------------------------
const hardcodedData = {
    "ONE DAY TRIP": [
        "Varkala Intl Beach","Kappil","Anjengo","Kulamuttom Lake","Kadinmkulam Lake",
        "Aakulam Lake","Vellayani Lake","Perumathura","Veli","Zoo","Napier Museum",
        "Wax Museum","Shangumugham Beach","Neeramankara Walkway","Kovalam Intl Beach",
        "Hawa Beach","Pozhikkara Beach","Samudra Beach Park","Vizhinjam","Poovar",
        "Aruvikkara Dam","Peppara Dam","Neyyar Dam","Meenmutty Dam","Kottur Ecotourism",
        "Podiyakala Peppara Vithura","Amboori","Bonacaud","Ponmudi","Punchakkari",
        "Palode Botanical Garden","Sai Gramam","Aruvikkara Eco Kattakada","Mayam Neyyar",
        "Happy Land Water Park"
    ],

    "WATERFALLS": [
        "Meenmutty Falls Kilimanoor","Thampurattipara Falls Kilimanoor","Para Kuzhi Falls Kilimanoor",
        "Meenmoodu Venjaramoodu","Erappil Falls Venjaramoodu","Muthipara Falls Venjaramoodu",
        "Irinchayam Falls Vembayam","Mankayam Falls Brimore","Meenmutty Falls Kallar",
        "Thavakkal Falls Vithura","Vazhvanthol Falls Kanithadam","Bonacaud Falls",
        "Kalluvaramb Falls Peyad","Aanakulam Falls Amboori","Irappam Falls Amboori",
        "Madasseri Falls Vellarada","Meenmutty Neyyar"
    ],

    "PALACE": [
        "Kilimanoor Palace","Attingal Palace","Nedumangad Palace","Kuthiramalika Palace",
        "Kanakakunnu Palace","Kowdiar Palace","Padmanabhapuram Palace","Kovalam Palace",
        "Varkala Palace"
    ],

    "HILL STATIONS": [
        "Thampuratti Hill Kilimanoor","Kadalukaani Hill Thalikuzhi","Vellanikkal Hill Venjaramoodu",
        "Vallikadu Hill Venjaramoodu","Ayyampara Hill Venjaramoodu","Shiva Hill Venjaramoodu",
        "Thampuran Hill Vembayam","Madavoorpara Pothencode","Aayiravalli Hill Nagaroor",
        "Thirichittoor Rock Nedumangad","Chittipara Vithura","Ponmudi Hill",
        "Varayadumotta Hill","Bison Valley Ponmudi","Sarkar Motta Ponmudi",
        "Sita Theertham Ponmudi","Maruthwamala Ponmudi","Agasthyarkoodam",
        "Kaalippara Neyyar","Koonichi Hill Vellarada","Plankudikavu Vellarada",
        "Kathirmudi Hill","Sasthampara Hill","Kadumbu Para","Draviyappara",
        "Nellikkamala","Njandupara Cave Amboori","Kurisumala Amboori",
        "Kannithoonmoodu Amboori"
    ],

    "TEMPLE MOSQUE CHURCH": [
        "Padmanabhaswamy Temple","Attukal","Iscon Temple","Beemapally","Palayam Church",
        "Vettukadu Church","Palayam Juma Masjid","Eruthavoor Kerala Palani","Karikkakom",
        "Sarkara Devi","Kaduvayil Juma Masjid","Azhimala Shiva Temple","Chenkal",
        "St Joseph Shrine Vizhinjam","Sivagiri Varkala","Santhigiri Ashram"
    ]
};

// Render hardcoded list
function renderHardcoded() {
    const div = document.getElementById("hardcoded");

    for (const category in hardcodedData) {
        let box = document.createElement("div");
        box.className = "category-box";

        box.innerHTML = `<h2>${category}</h2>`;

        hardcodedData[category].forEach(place => {
            box.innerHTML += `<div class="place">${place}</div>`;
        });

        div.appendChild(box);
    }
}
renderHardcoded();

// ----------------------------
// 2. LOAD COMMUNITY DATA (PapaParse)
// ----------------------------
const CSV_URL = 
"https://docs.google.com/spreadsheets/d/e/2PACX-1vQl3LmncwycLdYjhiLqkOEtzRUeidgIAkYM2y9tOc9LrAwOxb9hlCN4nM9Y2FDkrZLmV1w2HY_B7Wac/pub?output=csv";

function loadCommunity() {
    Papa.parse(CSV_URL, {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: function(results) {
            const community = [];

            results.data.forEach(r => {
                community.push({
                    category: r["Category"],
                    name: r["Place Name"],
                    addedBy: r["Added By"] || "Anonymous"
                });
            });

            renderCommunity(community);
        }
    });
}

function renderCommunity(list) {
    const div = document.getElementById("community");
    let box = document.createElement("div");
    box.className = "category-box";

    box.innerHTML = `<h2>Community Added Places</h2>`;

    if (list.length === 0) {
        box.innerHTML += "<p>No community submissions yet.</p>";
    }

    list.forEach(item => {
        box.innerHTML += `
            <div class="place">
                ${item.name} 
                <span style="color:#666; font-size:12px;">(${item.category})</span>
                <span class="community-badge">${item.addedBy}</span>
            </div>
        `;
    });

    div.appendChild(box);
}

loadCommunity();
</script>

<!-- Hidden Visitor Counter -->
<img src="https://counter.seku.su/counter.svg" style="display:none">

<footer>
    Page Visits: <span id="visitorCount">Loading...</span>
</footer>

<script>
// Initialize counter if not already created
fetch("https://api.countapi.xyz/create?namespace=tvm_places&key=visits&value=0")
  .then(() => fetch("https://api.countapi.xyz/hit/tvm_places/visits"))
  .then(res => res.json())
  .then(data => {
      document.getElementById("visitorCount").innerText = data.value;
  })
  .catch(err => {
      console.error("Error loading counter:", err);
      document.getElementById("visitorCount").innerText = "Unavailable";
  });
</script>

</body>
</html>
